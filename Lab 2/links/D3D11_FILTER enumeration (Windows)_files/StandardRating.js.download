(function(){var standardRatingControl=function($){function adjustRatingPosition(){isVoted?($("#standardRating").hide(),$("#standardRatingPlaceholder").hide()):$(document).scrollTop()+$(window).height()>=$("#ux-footer").position().top+$("#standardRating").height()||!isTimeout||isClosed||$(".locale-selection-panel").is(":visible")?($("#standardRating").removeClass("stdr-float"),$("#standardRating").css("width",$(window).width()),$("#standardRating").css("margin-left",-1*$("#standardRating").parent().offset().left+$(window).scrollLeft()),$("#standardRatingPlaceholder").hide(),$(".stdr-close").hide()):($("#standardRating").addClass("stdr-float"),$("#standardRating").css("width",$(window).width()),$("#standardRating").css("margin-left",0),$("#standardRatingPlaceholder").height($("#standardRating").height()).show(),$(".stdr-close").show())}function initWedcs(){$(".stdr-yes").on("click",function(){isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=yes","wcs.cn=yes","ms.cmpgrp=feedbackform")});$(".stdr-no").on("click",function(){isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=no","wcs.cn=no","ms.cmpgrp=feedbackform")});$(".stdr-provide").on("click",function(){if(isdefined("MscomCustomEvent")){var feedbackCharacterCount=Number($(".stdr-detail").attr("maxLength"))-Number($(".stdr-charcnt").text());MscomCustomEvent("ms.title=submit","wcs.cn=submit","ms.feedbackid="+($("#standardRating #s_ratingId").val()||feedbackCharacterCount),"ms.cmpgrp=feedbackform")}});$(".stdr-skip").on("click",function(){isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=skip this","wcs.cn=skip this","ms.cmpgrp=feedbackform")})}function toggleRatingEnablement(){$("#isTopicRated").val()==="true"&&showSection($thankYouSection)}function isV1Enabled(){return $("#ratingSubmitUrl")&&$("#ratingSubmitUrl").length>0}function isV2Enabled(){return $("#ratingValueSubmitUrl")&&$("#ratingValueSubmitUrl").length>0}function setupEventHandlers(){$(".stdr-close").click(function(){setCookie("msdn.epx.library.suggestion","enabled",365);isClosed=!0;adjustRatingPosition()});$(".stdr-yes").click(function(){$("#s_ratingValue").val(yesRating);isV2Enabled()&&submitRating();showSection($submitSection);$(".stdr-detail").focus()});$(".stdr-no").click(function(){$("#s_ratingValue").val(noRating);isV2Enabled()&&submitRating();showSection($submitSection);$(".stdr-detail").focus()});$submitButton.click(function(){var feedText=$("#standardRating div.stdr-feedback textarea").val();isV1Enabled()?submitRating(feedText):isV2Enabled()&&submitAdditionalFeedback(feedText)});$skipThisButton.click(function(){isV1Enabled()?submitRating(null):isV2Enabled()&&showSection($thankYouSection)});var maxChars=$("#feedbackTextCounter").text();maxChars||(maxChars=1500);$(".stdr-detail").on("keyup blur keydown",function(){textBoxCharactersCounter($(this),$(".stdr-charcnt"),maxChars)})}function showSection($section){$yesNoSection.hide();$submitSection.hide();$thankYouSection.hide();$section.show();$section===$thankYouSection&&($("#s_rateThisTopic").hide(),$("#s_rateThisPrefix").hide(),setTimeout(function(){isVoted=!0;adjustRatingPosition()},5e3))}function submitRating(text){var url,data;isV1Enabled()?($submitButton.attr("disabled","disabled"),$skipThisButton.attr("disabled","disabled"),url=$("#ratingSubmitUrl").val(),data={__RequestVerificationToken:$("input[name='__RequestVerificationToken']").last().val(),rdIsUseful:$("#standardRating #s_ratingValue").val(),feedbackText:text,onePubTopicId:$("#onePubTopicId").val(),returnUrl:window.location.href,isAsync:!0},$.ajax({type:"POST",url:url,data:data,async:!0,success:function(){log("Rating successfully submitted");setCookie("standardrating.voted","enabled",30,cookiePath);showSection($thankYouSection)},error:function(response){log("Rating submission failed: HTTP "+response.status);showSection($thankYouSection)}})):isV2Enabled()&&($yesButton.attr("disabled","disabled"),$noButton.attr("disabled","disabled"),url=$("#ratingValueSubmitUrl").val(),data={__RequestVerificationToken:$("input[name='__RequestVerificationToken']").last().val(),rdIsUseful:$("#standardRating #s_ratingValue").val(),returnUrl:window.location.href,isAsync:!0},$.ajax({type:"POST",url:url,data:data,dataType:"json",async:!0,success:function(data){log("Rating value successfully submitted");var ratingIdNode=$("<input id='s_ratingId' type='hidden' value='"+data.RatingId+"'>");$(ratingIdNode).insertAfter("#s_ratingValue")},error:function(response){log("Rating value submission failed: HTTP "+response.status)}}))}function submitAdditionalFeedback(text){if($submitButton.attr("disabled","disabled"),$skipThisButton.attr("disabled","disabled"),!text||$("#standardRating #s_ratingId").length==0||$("#ratingAdditionalSubmitUrl").length==0){showSection($thankYouSection);return}var url=$("#ratingAdditionalSubmitUrl").val(),data={__RequestVerificationToken:$("input[name='__RequestVerificationToken']").last().val(),ratingId:$("#standardRating #s_ratingId").val(),feedbackText:text,returnUrl:window.location.href,isAsync:!0};$.ajax({type:"POST",url:url,data:data,async:!0,success:function(){log("Additonal feedback successfully submitted");setCookie("standardrating.voted","enabled",30,cookiePath);showSection($thankYouSection)},error:function(response){log("Additonal feedback submission failed: HTTP "+response.status);showSection($thankYouSection)}})}function textBoxCharactersCounter(control,charcnt,max){control.val().length>max?control.val(control.val().substring(0,max)):charcnt.html((max-control.val().length).toString())}function isdefined(variable){return typeof window[variable]=="undefined"?!1:!0}function log(message){!message||message.length<1||window.console.log(getDateTime()+" : "+message)}function error(message){!message||message.length<1||window.console.error(getDateTime()+" : "+message)}function padLeft(integer,width){if(!integer||!width||width<=1)return integer;for(integer=integer+"";integer.length<width;)integer="0"+integer;return integer}function getDateTime(date){return date||(date=new Date),padLeft(date.getFullYear(),4)+"-"+padLeft(date.getMonth()+1,2)+"-"+padLeft(date.getDate(),2)+" "+padLeft(date.getHours(),2)+":"+padLeft(date.getMinutes(),2)+":"+padLeft(date.getSeconds(),2)+":"+padLeft(date.getMilliseconds(),3)}function setCookie(name,value,expires,path,domain,secure,noEscape){var today=new Date,expiresDate;today.setTime(today.getTime());expires&&(expires=expires*864e5);expiresDate=new Date(today.getTime()+expires);noEscape||(value=escape(value));document.cookie=name+"="+value+(expires?";expires="+expiresDate.toGMTString():"")+(path?";path="+path:"")+(domain?";domain="+domain:"")+(secure?";secure":"")}function getCookie(sName,defaultValue){for(var aCookie=document.cookie.split("; "),aCrumb,i=0;i<aCookie.length;i++)if(aCrumb=aCookie[i].split("="),sName===aCrumb[0])return unescape(aCrumb[1]);return defaultValue}var yesRating=1,noRating=0,$yesNoSection,$submitSection,$thankYouSection,$submitButton,$skipThisButton,isTimeout=!1,isClosed=!0,isVoted=!1,cookiePath=null;return document&&document.location&&document.location.pathname&&(cookiePath=document.location.pathname),$(document).ready(function(){if($("#openFeedbackContainer").length>0){$("#standardRatingBefore").css("display","none");return}$("#standardRating").length!=0&&($("#standardRating").css("direction")=="rtl"&&$("#standardRating").attr("dir","rtl"),isClosed=getCookie("msdn.epx.library.suggestion","disabled")==="disabled"?!1:!0,isVoted=getCookie("standardrating.voted","disabled")==="disabled"?!1:!0,$yesNoSection=$("#standardRating .stdr-vote"),$submitSection=$("#standardRating .stdr-feedback"),$thankYouSection=$("#standardRating .stdr-thanks"),$yesButton=$("#standardRating .stdr-yes"),$noButton=$("#standardRating .stdr-no"),$submitButton=$("#standardRating .stdr-provide"),$skipThisButton=$("#standardRating .stdr-skip"),toggleRatingEnablement(),setupEventHandlers(),initWedcs(),adjustRatingPosition(),setTimeout(function(){isTimeout=!0;adjustRatingPosition()},3e4),$(window).scroll(function(){adjustRatingPosition()}),window.onresize=function(){adjustRatingPosition()},$("#standardRating").css("display","block"))}),{adjustRatingPosition:adjustRatingPosition}};typeof define=="function"&&window.mtpsAmd?define("standardRating",["jquery"],function($){return standardRatingControl($)}):(window.epx=window.epx||{},window.epx.windowsStandardRating=standardRatingControl($))})();