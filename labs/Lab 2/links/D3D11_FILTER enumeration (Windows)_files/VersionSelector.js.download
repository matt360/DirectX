epx=window.epx||{};epx.versionSelector=function(){function init(){function hideListIfNeed(){$list.is(":visible")&&($list.hide(),$link.attr("aria-expanded","false"))}function toggleLinkAriaAttr(){$link.attr("aria-expanded")==="true"?$link.attr("aria-expanded","false"):$link.attr("aria-expanded","true")}$link<=0||$arrow<=0||$list<=0||$expand<=0||($link.click(function(){$list.toggle();toggleLinkAriaAttr()}),$arrow.click(function(){$list.toggle();toggleLinkAriaAttr()}),$(document).mouseup(function(event){event.target.id!=="vsLink"&&event.target.id!=="vsArrow"&&$list.has(document.activeElement).length==0&&hideListIfNeed()}),$("#vsLink, #vsArrow, #vsPanel, #vsPanel li a").keyup(function(event){event.keyCode===27&&(hideListIfNeed(),$link.focus())}),$list.focusout(function(){$list.has(document.activeElement).length==0&&hideListIfNeed()}),addArchiveIcon($list))}function addArchiveIcon($target){$nodes=$target.find("li.archived");$nodes.length>0&&($archiveInfo="The document is archived and information here might be outdated",$("div#isd_archiveInstrument").length>0&&($archiveInfo=$("div#isd_archiveInstrument").text()),$insertArchiveIcon=$("<a href='javascript:void(0)' role='img' title='"+$archiveInfo+"'><\/a>"),$nodes.each(function(){$clone=$insertArchiveIcon.clone();$(this).prepend($clone);$clone.click(function(e){return!1})}),$target.find("li:not(.archived)").each(function(){$(this).prepend($("<span class='emptyArchiveIcon'><\/span>"))}))}var $link=$("#vsLink"),$arrow=$("#vsArrow"),$list=$("#vsPanel"),$expand=$("#vsExpand");return{init:init}}();$(document).ready(function(){epx.versionSelector.init()});